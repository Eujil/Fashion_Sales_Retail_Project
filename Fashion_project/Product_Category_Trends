--How do monthly sales trends differ by product category (e.g., tops, pants, accessories)?

--Tops
SELECT EXTRACT(YEAR FROM date_purchase) AS year, EXTRACT(MONTH from date_purchase) AS month, SUM(purchase_amount_usd) AS total_sales,
  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END AS product_category
FROM customer_purchases
WHERE item_purchased IS NOT NULL AND purchase_amount_usd IS NOT NULL AND 
  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END = 'Tops'
GROUP BY product_category, EXTRACT(MONTH from date_purchase), EXTRACT(YEAR FROM date_purchase)
ORDER BY SUM(purchase_amount_usd) DESC;

-- Peak December 15394 and Lowest is September 4329


--Bottoms
SELECT EXTRACT(YEAR FROM date_purchase) AS year, EXTRACT(MONTH from date_purchase) AS month, SUM(purchase_amount_usd) AS total_sales,

  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END AS product_category
FROM customer_purchases
WHERE item_purchased IS NOT NULL AND purchase_amount_usd IS NOT NULL AND 
  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END = 'Bottoms'
GROUP BY product_category, EXTRACT(MONTH from date_purchase), EXTRACT(YEAR FROM date_purchase)
ORDER BY SUM(purchase_amount_usd) DESC;

--For Bottoms, its peak was May having 11562 total sales, its lowest is January with 2419 sales 


-- One-Piece Outfits 
SELECT EXTRACT(YEAR FROM date_purchase) AS year, EXTRACT(MONTH from date_purchase) AS month, SUM(purchase_amount_usd) AS total_sales,

  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END AS product_category
FROM customer_purchases
WHERE item_purchased IS NOT NULL AND purchase_amount_usd IS NOT NULL AND 
  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END = 'One-Piece Outfits'
GROUP BY product_category, EXTRACT(MONTH from date_purchase), EXTRACT(YEAR FROM date_purchase)
ORDER BY SUM(purchase_amount_usd) DESC;

-- Peak December with 9486 Lowest February 1895

-- Footwear
SELECT EXTRACT(YEAR FROM date_purchase) AS year, EXTRACT(MONTH from date_purchase) AS month, SUM(purchase_amount_usd) AS total_sales,

  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END AS product_category
FROM customer_purchases
WHERE item_purchased IS NOT NULL AND purchase_amount_usd IS NOT NULL AND 
  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END = 'Footwear'
GROUP BY product_category, EXTRACT(MONTH from date_purchase), EXTRACT(YEAR FROM date_purchase)
ORDER BY SUM(purchase_amount_usd) DESC;

-- Peak June 11237, Lowest May 1531



--Accessories
SELECT EXTRACT(YEAR FROM date_purchase) AS year, EXTRACT(MONTH from date_purchase) AS month, SUM(purchase_amount_usd) AS total_sales,

  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END AS product_category
FROM customer_purchases
WHERE item_purchased IS NOT NULL AND purchase_amount_usd IS NOT NULL AND 
  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END = 'Accessories'
GROUP BY product_category, EXTRACT(MONTH from date_purchase), EXTRACT(YEAR FROM date_purchase)
ORDER BY SUM(purchase_amount_usd) DESC;

--Peak May 10785, Lowest September 2590

--Bag n Wallets 
SELECT EXTRACT(YEAR FROM date_purchase) AS year, EXTRACT(MONTH from date_purchase) AS month, SUM(purchase_amount_usd) AS total_sales,

  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END AS product_category
FROM customer_purchases
WHERE item_purchased IS NOT NULL AND purchase_amount_usd IS NOT NULL AND 
  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END = 'Bags and Wallets'
GROUP BY product_category, EXTRACT(MONTH from date_purchase), EXTRACT(YEAR FROM date_purchase)
ORDER BY SUM(purchase_amount_usd) DESC;


--Swimwear
SELECT EXTRACT(YEAR FROM date_purchase) AS year, EXTRACT(MONTH from date_purchase) AS month, SUM(purchase_amount_usd) AS total_sales,

  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END AS product_category
FROM customer_purchases
WHERE item_purchased IS NOT NULL AND purchase_amount_usd IS NOT NULL AND 
  CASE
  WHEN item_purchased = 'Jacket' THEN 'Outwear'
  WHEN item_purchased = 'Trench Coat' THEN 'Outwear' 
  WHEN item_purchased = 'Coat' THEN 'Outwear'
  WHEN item_purchased = 'Raincoat' THEN 'Outwear'
  WHEN item_purchased = 'Blazer' THEN 'Outwear'
  WHEN item_purchased = 'Poncho' THEN 'Outwear'
  WHEN item_purchased = 'Kimono' THEN 'Outwear'
  WHEN item_purchased = 'T-shirt' THEN 'Tops'
  WHEN item_purchased = 'Tank Top' THEN 'Tops'
  WHEN item_purchased = 'Blouse' THEN 'Tops'
  WHEN item_purchased = 'Flannel Shirt' THEN 'Tops'
  WHEN item_purchased = 'Polo Shirt' THEN 'Tops'
  WHEN item_purchased = 'Tunic' THEN 'Tops'
  WHEN item_purchased = 'Camisole' THEN 'Tops'
  WHEN item_purchased = 'Sweater' THEN 'Tops'
  WHEN item_purchased = 'Hoodie' THEN 'Tops'
  WHEN item_purchased = 'Cardigan' THEN 'Tops'
  WHEN item_purchased = 'Vest' THEN 'Tops'
  WHEN item_purchased = 'Jeans' THEN 'Bottoms'
  WHEN item_purchased = 'Pants' THEN 'Bottoms'
  WHEN item_purchased = 'Trousers' THEN 'Bottoms'
  WHEN item_purchased = 'Shorts' THEN 'Bottoms'
  WHEN item_purchased = 'Leggings' THEN 'Bottoms'
  WHEN item_purchased = 'Skirt' THEN 'Bottoms'
  WHEN item_purchased = 'Dress' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Jumpsuit' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Romper' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Overalls' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Pajamas' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Onesie' THEN 'One-Piece Outfits'
  WHEN item_purchased = 'Sneakers' THEN 'Footwear'
  WHEN item_purchased = 'Boots' THEN 'Footwear'
  WHEN item_purchased = 'Sandals' THEN 'Footwear'
  WHEN item_purchased = 'Flip-Flops' THEN 'Footwear'
  WHEN item_purchased = 'Loafers' THEN 'Footwear'
  WHEN item_purchased = 'Slippers' THEN 'Footwear'
  WHEN item_purchased = 'Hat' THEN 'Accessories'
  WHEN item_purchased = 'Sun Hat' THEN 'Accessories'
  WHEN item_purchased = 'Gloves' THEN 'Accessories'
  WHEN item_purchased = 'Scarf' THEN 'Accessories'
  WHEN item_purchased = 'Tie' THEN 'Accessories'
  WHEN item_purchased = 'Bowtie' THEN 'Accessories'
  WHEN item_purchased = 'Sunglasses' THEN 'Accessories'
  WHEN item_purchased = 'Belt' THEN 'Accessories'
  WHEN item_purchased = 'Umbrella' THEN 'Accessories'
  WHEN item_purchased = 'Handbag' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Backpack' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Wallet' THEN 'Bags and Wallets'
  WHEN item_purchased = 'Swimsuit' THEN 'Swimwear'
  ELSE 'no category'
END = 'Swimwear'
GROUP BY product_category, EXTRACT(MONTH from date_purchase), EXTRACT(YEAR FROM date_purchase)
ORDER BY SUM(purchase_amount_usd) DESC;

-- Peak February 3640, Lowest May 167
